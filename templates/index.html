<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Server Ressursmåler</title>
</head>
<body>
    <h1>Server Ressursmåler</h1>
    <table border="1">
        <tr>
            <th>Tid</th>
            <th>CPU (%)</th>
            <th>Minne (%)</th>
            <th>Disk (%)</th>
            <th>Nettverk trafikk (bytes)</th>
        </tr>
        {% for metric in metrics %}
        <tr>
            <td>{{ metric.timestamp }}</td>
            <td>{{ metric.cpu_usage }}</td>
            <td>{{ metric.memory_usage }}</td>
            <td>{{ metric.disk_usage }}</td>
            <td>{{ metric.network_traffic }}</td>
        </tr>
        {% endfor %}
    </table>
<div class="bg-white p-4 rounded-lg shadow-lg mb-8">
	<h2 class="text-2xl font-semibold text-blue-600 mb-4">Live statistikk</h2>
	<p><strong>CPU Bruk:</strong> <span id="live-cpu">Laster...</span>%</p>
	<p><strong>Minne Bruk:</strong> <span id="live-minne">Laster...</span>%</p>
	<p><strong>Disk Bruk:</strong> <span id="live-disk">Laster...</span>%</p>
</div>

 
<script>
    // Funksjon som henter stats
    async function hentLiveStats() {
        try {
            // Henter data fra /system-stats endpoint
            const response = await fetch('/system-stats');
            
            // Sjekk om respons OK (status 200)
            if (!response.ok) {
                throw new Error(`HTTP error! Status: ${response.status}`);
            }

            // Venter på JSON respons 
            const data = await response.json();

            // Oppdatering av HTML
            document.getElementById('live-cpu').innerText = data.cpu_usage;
            document.getElementById('live-minne').innerText = data.ram_usage;
            document.getElementById('live-disk').innerText = data.disk_usage;
        } catch (error) {
            console.error('Error fetching live stats:', error);
        }
    }

    // Hent data hvert 5 sekund
    setInterval(hentLiveStats, 5000);
    hentLiveStats(); // Første henting når siden laster
</script>
</body>
</html>
